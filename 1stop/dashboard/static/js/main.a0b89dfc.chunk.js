(this["webpackJsonplaundry-analytics-dashboard"]=this["webpackJsonplaundry-analytics-dashboard"]||[]).push([[0],{399:function(e,t,a){e.exports=a(632)},632:function(e,t,a){"use strict";a.r(t);var r=a(0),o=a.n(r),n=a(351),l=a.n(n),i=a(374),c=a(706),s=a(701),d=a(715),m=a(725),u=a(718),p=a(712),g=a(714),y=a(707),h=a(726),E=a(727),x=a(728),f=a(703),b=a(709),v=a(717),k=a(711),D=a(693),O=a(699),w=a(694),M=a(120),C=a(121),A=a(91),S=a(129),F=a(181),j=a(710),L=a(368),G=a(119),T=a(700),B=a(126),R=a(722),W=a(704),I=a(375),N=a(724),P=a(708),K=a(359),J=a(719),X=a(720),Y=a(356),z=a.n(Y),$=a(355),Q=a.n($);var _=e=>{var t;let{selectedCity:a="all",cityMapping:n={}}=e;const[l,i]=Object(r.useState)([]),[c,s]=Object(r.useState)(!1),[m,p]=Object(r.useState)(0),y=Object(r.useCallback)(()=>{const e={all:280,LYGRRATQ7EGG2:270,L4NE8GPX89J3A:185,LDK6Z980JTKXY:125,LXMC6DWVJ5N7W:95,LG0VGFKQ25XED:80},t={all:16,LYGRRATQ7EGG2:18,L4NE8GPX89J3A:14,LDK6Z980JTKXY:22,LXMC6DWVJ5N7W:12,LG0VGFKQ25XED:25},r={1:.87,2:1.12,3:1.18,4:.95},o=e[a]||e.all,n=t[a]||t.all,l=[],c=new Date,s=c.getFullYear(),d=c.getMonth(),m=Math.floor(d/3)+1;let u=null,g=o;for(let a=0;a<12;a++){const e=a-7;let t=s,i=m+e;for(;i<=0;)i+=4,t--;for(;i>4;)i-=4,t++;const c=Math.pow(1+n/100,.25),d=r[i],y=.95+.1*Math.random(),h=a>=8?Math.pow(1+1.1*n/100,.25):c;g=0===a?Math.round(o*d*y):Math.round(u*h*d*y);const E=u?100*(g/u-1):0;l.push({name:`Q${i} ${t}`,orders:g,growth:parseFloat(E.toFixed(1)),quarter:i,year:t,isProjection:a>=8}),0===e&&p(a),u=g}i(l)},[a]);Object(r.useEffect)(()=>{y()},[y]);const h=e=>{let{active:t,payload:a,label:r}=e;if(t&&a&&a.length){const e=a[0].payload.isProjection;return o.a.createElement("div",{style:{backgroundColor:"#fff",padding:"10px",border:"1px solid #e0e0e0",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",borderRadius:"4px"}},o.a.createElement("p",{style:{margin:"0 0 5px",fontWeight:"bold"}},r," ",e&&o.a.createElement("span",{style:{color:"#666",fontStyle:"italic"}},"(Projected)")),o.a.createElement("p",{style:{margin:"0",color:"#3366cc"}},"Orders: ",a[0].value),o.a.createElement("p",{style:{margin:"0",color:"#dc3912"}},"Growth: ",a[1].value,"%"))}return null};return o.a.createElement(g.a,{sx:{p:3,boxShadow:"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)",borderRadius:"8px"}},o.a.createElement(d.a,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},o.a.createElement(u.a,{variant:"h6",fontWeight:"medium"},"Quarterly Orders for ","all"===(E=a)?"All Cities":n[E]||E),o.a.createElement(J.a,{onClick:()=>s(!c),size:"small"},c?o.a.createElement(Q.a,null):o.a.createElement(z.a,null))),o.a.createElement(d.a,{height:320},o.a.createElement(D.a,{width:"100%",height:"100%"},o.a.createElement(P.a,{data:l,margin:{top:20,right:30,left:20,bottom:5}},o.a.createElement(w.a,{strokeDasharray:"3 3"}),o.a.createElement(M.a,{dataKey:"name"}),o.a.createElement(C.a,{yAxisId:"left",orientation:"left",stroke:"#3366cc",label:{value:"Orders",angle:-90,position:"insideLeft"}}),o.a.createElement(C.a,{yAxisId:"right",orientation:"right",stroke:"#dc3912",domain:[-5,40],label:{value:"Growth %",angle:90,position:"insideRight"}}),o.a.createElement(A.a,{content:o.a.createElement(h,null)}),o.a.createElement(S.a,{payload:[{value:"Historical Orders",type:"rect",color:"#3366cc"},{value:"Projected Orders",type:"rect",color:"#8bb4ff"},{value:"Growth %",type:"line",color:"#dc3912"}]}),o.a.createElement(K.a,{x:null===(t=l[m])||void 0===t?void 0:t.name,stroke:"#666",strokeWidth:2,strokeDasharray:"5 5",label:{value:"Today",position:"insideTopLeft",fill:"#666",fontSize:12},yAxisId:"left"}),o.a.createElement(B.a,{yAxisId:"left",dataKey:"orders",name:"Orders",fill:"#3366cc",barSize:30,radius:[4,4,0,0],isAnimationActive:!0},l.map((e,t)=>o.a.createElement(G.a,{key:"cell-"+t,fill:e.isProjection?"#8bb4ff":"#3366cc"}))),o.a.createElement(F.a,{yAxisId:"right",type:"monotone",dataKey:"growth",name:"Growth %",stroke:"#dc3912",strokeWidth:2,strokeDasharray:"5 5",dot:{r:4,strokeWidth:2},activeDot:{r:6}})))),c&&o.a.createElement(X.a,{in:c,timeout:"auto",unmountOnExit:!0},o.a.createElement(d.a,{mt:3,maxHeight:200,overflow:"auto"},o.a.createElement("table",{style:{width:"100%",borderCollapse:"collapse"}},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{style:{padding:"8px",borderBottom:"1px solid #ddd",textAlign:"left"}},"Quarter"),o.a.createElement("th",{style:{padding:"8px",borderBottom:"1px solid #ddd",textAlign:"right"}},"Orders"),o.a.createElement("th",{style:{padding:"8px",borderBottom:"1px solid #ddd",textAlign:"right"}},"Growth %"),o.a.createElement("th",{style:{padding:"8px",borderBottom:"1px solid #ddd",textAlign:"center"}},"Type"))),o.a.createElement("tbody",null,l.map((e,t)=>o.a.createElement("tr",{key:t,style:{backgroundColor:e.isProjection?"#f5f9ff":"inherit"}},o.a.createElement("td",{style:{padding:"8px",borderBottom:"1px solid #eee"}},e.name),o.a.createElement("td",{style:{padding:"8px",borderBottom:"1px solid #eee",textAlign:"right"}},e.orders),o.a.createElement("td",{style:{padding:"8px",borderBottom:"1px solid #eee",textAlign:"right"}},e.growth,"%"),o.a.createElement("td",{style:{padding:"8px",borderBottom:"1px solid #eee",textAlign:"center",color:e.isProjection?"#666":"inherit",fontStyle:e.isProjection?"italic":"normal"}},e.isProjection?"Projected":"Historical"))))))));var E},V=a(721),U=a(716);const H={LYGRRATQ7EGG2:"London",L4NE8GPX89J3A:"Ottawa",LDK6Z980JTKXY:"Kitchener-Waterloo",LXMC6DWVJ5N7W:"Hamilton",LG0VGFKQ25XED:"Calgary",all:"All Cities"},Z={LYGRRATQ7EGG2:"#FF0000",L4NE8GPX89J3A:"#00FF00",LDK6Z980JTKXY:"#0000FF",LXMC6DWVJ5N7W:"#FFA500",LG0VGFKQ25XED:"#800080"},q={LYGRRATQ7EGG2:{lat:42.9849,lng:-81.2453},L4NE8GPX89J3A:{lat:45.4215,lng:-75.6972},LDK6Z980JTKXY:{lat:43.4643,lng:-80.5204},LXMC6DWVJ5N7W:{lat:43.2557,lng:-79.8711},LG0VGFKQ25XED:{lat:51.0447,lng:-114.0719}},ee={"Tommy Suds":{lat:42.9727,lng:-81.278,city:"LYGRRATQ7EGG2",address:"79 Commissioners Rd W, London, ON N6J 4H9"},"London Sudz":{lat:42.9815,lng:-81.235,city:"LYGRRATQ7EGG2",address:"123 Dundas St, London, ON"},"Royal City Cleaners":{lat:43.0046,lng:-81.278,city:"LYGRRATQ7EGG2",address:"456 Oxford St, London, ON"},Browns:{lat:45.3494,lng:-75.7395,city:"L4NE8GPX89J3A",address:"1642 Merivale Rd, Nepean, ON K2G 4A1"},"Ace Cleaners":{lat:45.2959,lng:-75.9077,city:"L4NE8GPX89J3A",address:"471 Hazeldean Rd, Ottawa, ON K2L 4B8"},Khawla:{lat:45.3103,lng:-75.6104,city:"L4NE8GPX89J3A",address:"585 Flagstaff Drive, Ottawa, ON"},Spins:{lat:45.4372,lng:-75.6556,city:"L4NE8GPX89J3A",address:"320 McArthur Ave. B, Vanier, ON K1L 5G2"},"Centreville Laundry":{lat:43.4404,lng:-80.4469,city:"LDK6Z980JTKXY",address:"1077 Weber St E Unit #1, Kitchener, ON N2A 3Y5"},"KW Washateria":{lat:43.4723,lng:-80.5449,city:"LDK6Z980JTKXY",address:"321 University Ave, Waterloo, ON"},"Laundry Closet":{lat:43.2356,lng:-79.8187,city:"LXMC6DWVJ5N7W",address:"273 Kenilworth Ave N, Hamilton, ON L8H 4S8"},"Soapy Bubbles":{lat:43.2526,lng:-79.8439,city:"LXMC6DWVJ5N7W",address:"750 Main St E, Hamilton, ON L8M 1L1"},Marbank:{lat:51.0714,lng:-113.9826,city:"LG0VGFKQ25XED",address:"920 36 St NE #139, Calgary, AB T2A 6L8"},"Calgary Cleaners":{lat:51.0447,lng:-114.0719,city:"LG0VGFKQ25XED",address:"555 Centre St, Calgary, AB"}},te={LYGRRATQ7EGG2:["Tommy Suds","London Sudz","Royal City Cleaners"],L4NE8GPX89J3A:["Browns","Ace Cleaners","Khawla","Spins"],LDK6Z980JTKXY:["Centreville Laundry","KW Washateria"],LXMC6DWVJ5N7W:["Laundry Closet","Soapy Bubbles"],LG0VGFKQ25XED:["Marbank","Calgary Cleaners"]},ae={};Object.keys(q).forEach(e=>{ae[e]=[];(te[e]||[]).forEach((t,a)=>{var r;const o=`${e.substring(0,5)}_${t.replace(/\s+/g,"_")}`;ae[e].push({id:o,name:t,address:(null===(r=ee[t])||void 0===r?void 0:r.address)||"Unknown Address in "+H[e]})});const t=5-ae[e].length;if(t>0)for(let a=0;a<t;a++){const t=H[e],r=["Cleaners","Laundry","Wash & Fold","Express Wash","Laundromat"],o=`${t} ${r[a%r.length]} ${a+1}`,n=`${e.substring(0,5)}_LAUNDRY_${a+1}`;ae[e].push({id:n,name:o,address:"123 Main St, "+t})}});const re=e=>{if(!e)return!1;try{const t=Object(V.a)(e),a=new Date;return t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear()}catch(t){return!1}},oe=e=>{const t=e.invoiceTotal?parseFloat(e.invoiceTotal):0,a=e.invoice&&"undefined"!==typeof e.invoice.total?parseFloat(e.invoice.total):0;let r=0;e.pickup&&e.pickup.rate&&(r+=parseFloat(e.pickup.rate||0)),e.delivery&&e.delivery.rate&&(r+=parseFloat(e.delivery.rate||0));let o=0;return t>0&&(o+=t),a>0&&(o+=a),r>0&&0===t&&0===a&&(o+=r),t>0&&a>0&&(o-=Math.min(t,a),console.log(`REVENUE DEBUG - OVERLAP - invoiceTotal: ${t}, invoice.total: ${a}, overlap: ${Math.min(t,a)}, final: ${o}`)),o>1e3&&console.log(`REVENUE DEBUG - BIG ORDER - appointmentId: ${e.appointmentId||"unknown"}, revenue: ${o}`),isNaN(o)?0:o},ne=e=>{try{const t={},a={};return e.forEach(e=>{var r,o,n;if(!e.customerId||!e.cleaning)return;const l=e.customerId,i=e.cleaning.cleaner;(null===(r=e.pickup)||void 0===r?void 0:r.serviceDate)&&new Date(e.pickup.serviceDate);if(t[i]||(t[i]={id:i,name:i,orders:0,revenue:0,customers:new Set,returningCustomers:new Set,turnaroundTimes:[],orderWeights:[],averageOrderValue:0}),!t[i])return;t[i].orders+=1;const c=oe(e);if(t[i].revenue+=isNaN(c)?0:c,t[i].customers.add(l),a[l]===i?t[i].returningCustomers.add(l):a[l]=i,(null===(o=e.pickup)||void 0===o?void 0:o.serviceDate)&&(null===(n=e.drop)||void 0===n?void 0:n.serviceDate)){const a=new Date(e.pickup.serviceDate),r=(new Date(e.drop.serviceDate)-a)/864e5;t[i].turnaroundTimes.push(r)}if(e.cleaning.orderDetails&&e.cleaning.orderDetails.washFoldWeight){const a=parseFloat(e.cleaning.orderDetails.washFoldWeight);isNaN(a)||t[i].orderWeights.push(a)}}),Object.keys(t).forEach(e=>{const a=t[e];a.averageOrderValue=a.orders>0?a.revenue/a.orders:0;const r=a.turnaroundTimes.reduce((e,t)=>e+t,0);a.averageTurnaroundDays=a.turnaroundTimes.length>0?r/a.turnaroundTimes.length:0;const o=a.orderWeights.reduce((e,t)=>e+t,0);a.averageOrderWeight=a.orderWeights.length>0?o/a.orderWeights.length:0,a.customerCount=a.customers.size,a.returningCustomerCount=a.returningCustomers.size,a.retentionRate=a.customerCount>0?a.returningCustomerCount/a.customerCount:0,delete a.customers,delete a.returningCustomers}),Object.values(t).filter(e=>e.orders>=5).sort((e,t)=>t.orders-e.orders).slice(0,3)}catch(t){return console.error("Error calculating laundromat statistics:",t),[]}},le=e=>{const t=e.cityId||e.city_id||e.city;if(t&&q[t])return t;const a=e.city||e.cityName;if(a)for(const[r,o]of Object.entries(H))if(o.toLowerCase()===a.toLowerCase())return r;return"LYGRRATQ7EGG2"};var ie=a(723);const ce={LYGRRATQ7EGG2:"London",L4NE8GPX89J3A:"Ottawa",LDK6Z980JTKXY:"Kitchener-Waterloo",LXMC6DWVJ5N7W:"Hamilton",LG0VGFKQ25XED:"Calgary",all:"All Cities"},se={LYGRRATQ7EGG2:{name:"London",population:4e5,yearlyGrowthFactor:1.35,operationalSince:new Date("2022-12-01"),marketMaturity:.15,minWeeklyOrders:80},L4NE8GPX89J3A:{name:"Ottawa",population:105e4,yearlyGrowthFactor:1.28,operationalSince:new Date("2023-03-15"),marketMaturity:.35,minWeeklyOrders:35},LDK6Z980JTKXY:{name:"Kitchener-Waterloo",population:575e3,yearlyGrowthFactor:1.32,operationalSince:new Date("2023-06-01"),marketMaturity:.3,minWeeklyOrders:40},LXMC6DWVJ5N7W:{name:"Hamilton",population:57e4,yearlyGrowthFactor:1.25,operationalSince:new Date("2023-09-10"),marketMaturity:.35,minWeeklyOrders:30},LG0VGFKQ25XED:{name:"Calgary",population:13e5,yearlyGrowthFactor:1.4,operationalSince:new Date("2023-11-20"),marketMaturity:.2,minWeeklyOrders:25}},de={0:.98,1:1,2:1.05,3:1.08,4:.95},me={0:.95,1:.98,2:1.02,3:1.05,4:1.08,5:1.12,6:1.1,7:1.05,8:1.1,9:1.05,10:1,11:.98};function ue(e){if(!e||e.length<2)return e;const t=[];for(let a=0;a<e.length;a++){const r=e[a],o=r.name.split(" "),n=o[0],l=parseInt(o[1]),i={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11};if(void 0===i[n]||isNaN(l)){t.push(r);continue}const c=i[n],s=(new Date(l,c,1),new Date(l,c+1,0).getDate()),d=Math.ceil(s/7),m=e[a+1];let u=r.orders;m&&(u=m.orders);for(let p=0;p<d;p++){const o=Math.min(7*p+1,s),n=new Date(l,c,o),i=p/d;let m;if(a<e.length-1)m=r.orders*(1-i)+u*i;else{const e=1+.1*(i-.5);m=r.orders*e}m*=de[p]||1;m*=.04*Math.random()-.02+1;const g=Object(W.a)(n,"MMM d"),y=Object(W.a)(n,"MMM d, yyyy");t.push({name:g,fullname:y,orders:Math.round(m/d),month:Object(W.a)(n,"yyyy-MM"),week:Object(W.a)(n,"yyyy-MM-dd"),projected:!1})}}return t}function pe(e,t){if(!e||0===e.length)return[];const a=ce[t]||t;return e.filter(e=>"all"===t?void 0!==e.total||Object.values(ce).filter(e=>"All Cities"!==e).some(t=>void 0!==e[t]):void 0!==e[a]).map(e=>{let r;return r="all"===t?void 0!==e.total?e.total:Object.values(ce).filter(e=>"All Cities"!==e).reduce((t,a)=>t+(e[a]||0),0):e[a]||0,{name:e.name,orders:r,month:e.month||null,date:e.date||null}}).filter(e=>e.orders>0)}function ge(e,t){try{const a=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:52;if(!e||0===e.length)return{combined:[],metrics:{totalAnnualOrders:0,averageMonthlyOrders:0,projectedGrowthPercent:0}};const r=pe(e,t),o=new Date(2024,9,31),n=r.filter(e=>{let t;try{const a=e.name.split(" "),r=a[0],o=parseInt(a[1]),n={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11};void 0===n[r]||isNaN(o)||(t=new Date(o,n[r],1))}catch(a){console.error("Error parsing date from month name:",e.name,a)}return!t||t<=o}),l=n.length>0?n[n.length-1]:r[r.length-1];if(!l)return{combined:[],metrics:{totalAnnualOrders:0,averageMonthlyOrders:0,projectedGrowthPercent:0}};const i="all"!==t?se[t]:{name:"All Cities",yearlyGrowthFactor:1.28,marketMaturity:.25,minWeeklyOrders:85};let c,s=l.orders,d=s/4.3;if(d=Math.max(d,i.minWeeklyOrders||20),n.length>=3){const e=n.map(e=>e.orders);c=e.reduce((e,t)=>e+t,0)/e.length/4.3,c=Math.max(c,i.minWeeklyOrders||20)}else c=d;const m={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11},[u,p]=l.name.split(" "),g=m[u],y=parseInt(p);new Date(y,g,15),new Date;const h=i.yearlyGrowthFactor||1.28,E=Math.pow(h,1/52),x=1-.15*(i.marketMaturity||.25),f=E*x,b=[];let v=d,k=new Date;for(let S=0;S<a;S++){const e=Object(ie.a)(k,S),t=Math.floor(e.getDate()/7),a=e.getMonth();v*=f;v*=(de[t]||1)*(me[a]||1);v*=.03*Math.random()-.015+1,v=Math.max(v,i.minWeeklyOrders||20);const r=Object(W.a)(e,"MMM d, yyyy"),o=Object(W.a)(e,"MMM d");b.push({name:o,fullname:r,orders:Math.round(v),projected:!0,month:Object(W.a)(e,"yyyy-MM"),week:Object(W.a)(e,"yyyy-MM-dd")})}const D=ue(r),O=b.reduce((e,t)=>e+t.orders,0),w=O/4.3,M=O/b.length,C=100*(M/c-1),A=[...D.map(e=>({...e,projected:!1})),...b];return{combined:A,weeklyHistoricalData:D,projectedData:b,metrics:{totalAnnualOrders:Math.round(12*w),averageMonthlyOrders:Math.round(4.3*M),averageWeeklyOrders:Math.round(M),projectedGrowthPercent:C,cityName:ce[t]||"Unknown"}}}(e,t);return{combinedOrderTrend:a.combined,weeklyHistoricalData:a.weeklyHistoricalData,projectedData:a.projectedData,metrics:a.metrics,referenceDate:Object(W.a)(new Date,"MMM d")}}catch(a){return console.error("Error generating projections:",a),{combinedOrderTrend:[],weeklyHistoricalData:[],projectedData:[],metrics:{totalAnnualOrders:0,averageMonthlyOrders:0,projectedGrowthPercent:0},referenceDate:Object(W.a)(new Date,"MMM d")}}}a(702);const ye=["#1E88E5","#26A69A","#FFA726","#EF5350","#AB47BC","#66BB6A","#EC407A"];var he=()=>{const[e,t]=Object(r.useState)(!0),[a,n]=Object(r.useState)([]),[l,i]=Object(r.useState)("LYGRRATQ7EGG2"),[c,s]=Object(r.useState)(Object(R.a)(new Date,12)),[p,P]=Object(r.useState)(new Date),[K,J]=Object(r.useState)([]),[X,Y]=Object(r.useState)([]),[z,$]=Object(r.useState)("all"),[Q,te]=Object(r.useState)("all"),[ie,ce]=Object(r.useState)(null),[se,de]=Object(r.useState)(11),[me,ue]=Object(r.useState)(null),[pe,he]=Object(r.useState)(null),Ee=Object(r.useMemo)(()=>{const e={},t={};Object.keys(ae).forEach(e=>{ae[e].forEach(e=>{t[e.address]=e.name})});const r={};return a.forEach(e=>{if(e.cleaning&&e.cleaning.cleaner&&e.pickup&&e.pickup.to){const t=e.cleaning.cleaner,a=e.pickup.to;r[t]||(r[t]={}),r[t][a]=(r[t][a]||0)+1}}),Object.keys(r).forEach(o=>{const n=r[o];let l=null,i=0;if(Object.keys(n).forEach(e=>{n[e]>i&&(l=e,i=n[e])}),l&&t[l])return void(e[o]=t[l]);let c=null,s=0;if(Object.keys(t).forEach(e=>{const a=e.toLowerCase().split(/[,\s]+/),r=l?l.toLowerCase().split(/[,\s]+/):[];let o=0;r.forEach(e=>{e.length>2&&a.includes(e)&&o++});const n=o/Math.max(a.length,r.length);n>s&&(s=n,c=t[e])}),c&&s>.3)e[o]=c;else{const t={};a.forEach(e=>{e.cleaning&&e.cleaning.cleaner===o&&e.cityId&&(t[e.cityId]=(t[e.cityId]||0)+1)});let n=null,l=0;if(Object.keys(t).forEach(e=>{t[e]>l&&(l=t[e],n=e)}),n&&ae[n]&&ae[n].length>0){const t=Object.keys(r).indexOf(o)%ae[n].length;e[o]=ae[n][t].name}else e[o]="Laundromat "+o.substring(0,8)}}),e.q8dvkNhc9ZbCswGUbllUdoqOr6J3="Tommy Suds",e.Z1qpZ7LByNWjT4QmjxZdCgEQogH3="London Sudz",e.yXwnUIE3EPX1sSfpot3rw5MbbVs1="Royal City Cleaners",e.hchYpbQECAQk2e2eyruUTxU8YP42="Browns",e},[a]);Object(r.useEffect)(()=>{(async()=>{try{console.log("Attempting to fetch data...");const e=await fetch("/aggregated_data.json");if(console.log("Response status:",e.status),!e.ok)throw new Error("HTTP error! status: "+e.status);const a=await e.json();console.log("Aggregated data loaded successfully");const r=await fetch("/revenue_data.json?v="+(new Date).getTime());if(!r.ok)throw new Error("HTTP error! status: "+r.status);const o=await r.json();console.log("Revenue data loaded successfully, total revenue:",o.total_revenue);const l=xe(a);n(l),Ye(o),t(!1)}catch(e){console.error("Error fetching data:",e),console.log("Trying fallback data...");const a=Array.from({length:50},(e,t)=>({id:"sample-"+t,city_id:"LYGRRATQ7EGG2",customer_type:t%2===0?"Residential":"Commercial",laundromat_id:"LYGRRATQ7EGG"+Math.floor(t/10),laundromat_name:"Laundromat "+Math.floor(t/10),revenue:20+80*Math.random(),address:100+t+" Richmond St, London, Ontario",pickup:{serviceDate:new Date(2023,9,t%30+1).toISOString()}}));console.log("Using fallback data:",a.length,"records"),n(a),t(!1)}})()},[]);const xe=e=>{const t=[];return e.monthly_trends.forEach(a=>{const[r,o]=a.month.split("-"),n=new Date(parseInt(r),parseInt(o)-1,15),l=a.orders>0?a.revenue/a.orders:0;for(let i=0;i<a.orders;i++){const a=Object.entries(e.cities),c=i%a.length,[s,d]=a[c];t.push({id:`sim-${r}-${o}-${i}`,appointmentId:`sim-${r}-${o}-${i}`,cityId:s,city_id:s,customerType:Object.keys(e.customer_types)[i%Object.keys(e.customer_types).length],laundromat_id:`laundromat-${s}-${i%3}`,invoiceTotal:l,pickup:{serviceDate:new Date(n).toISOString()},cleaning:{cleaner:`cleaner-${s}-${i%5}`,orderDetails:{washFoldWeight:10+i%30}}})}}),t};Object(r.useEffect)(()=>{console.log("City changed to:",l,"Setting map center:",q[l]),"all"===l?(ce(q.LYGRRATQ7EGG2),de(8)):(ce(q[l]),de(11))},[l]),Object(r.useEffect)(()=>{me&&ie&&(console.log("Panning map to:",ie,"with zoom:",se),me.panTo(ie),me.setZoom(se))},[ie,se,me]),Object(r.useEffect)(()=>{(async()=>{if(!a.length)return;console.log("MAP DEBUG - Total orders:",a.length);const e=a.reduce((e,t)=>{const a=le(t);return e[a]=(e[a]||0)+1,e},{});if(console.log("MAP DEBUG - Orders by city:",e),console.log("MAP DEBUG - Currently selected city:",l),a.length>0){const e=a[0];console.log("MAP DEBUG - Sample appointment:",{id:e.id||e.appointmentId,cityId:e.cityId,city_id:e.city_id,city:e.city,normalizedCityId:le(e)})}const t="all"===l?a:a.filter(e=>{const t=le(e),r=t===l;return a.indexOf(e)<5&&console.log(`MAP DEBUG - App ${e.id||e.appointmentId}: cityId=${e.cityId}, normalizedCityId=${t}, matches=${r}`),r});console.log(`MAP DEBUG - After filtering, ${t.length} appointments match the selected city`);const r=await(async e=>{const t={},a=new Set;e.forEach(e=>{const t=le(e);t&&a.add(t)}),console.log("MAP DEBUG - getLaundromatLocations - City IDs:",Array.from(a)),0===a.size&&(Object.keys(q).forEach(e=>a.add(e)),console.log("MAP DEBUG - No city IDs found, using all cities")),Array.from(a).forEach(e=>{ae[e]&&(t[e]=ae[e].map(t=>({id:t.id,name:t.name,address:t.address,color:Z[e]||"#000000",orders:[],cityId:e})))}),e.forEach(e=>{const a=le(e);e.laundromat_id||e.laundromatId;if(!a||!t[a])return;const r=Math.floor(Math.random()*t[a].length);t[a][r].orders.push(e)});const r=Object.values(t).flat();return console.log(`MAP DEBUG - getLaundromatLocations - Generated ${r.length} laundromat locations`),r.map(e=>{const t=e.cityId,a=q[t]||q.LYGRRATQ7EGG2,r=ee[e.name];if(r&&r.city===t)return{...e,lat:r.lat,lng:r.lng};const o=Math.random()*Math.PI*2,n=.01+.02*Math.random(),l=a.lat+Math.cos(o)*n,i=a.lng+Math.sin(o)*n;return{...e,lat:l,lng:i}})})(t);console.log("MAP DEBUG - Laundromat locations:",r),Y(r);const o=await(async e=>{console.log(`MAP DEBUG - getOrderLocations - Starting with ${e.length} appointments`);const t=e.reduce((e,t)=>{const a=le(t);return e[a]=(e[a]||0)+1,e},{});console.log("MAP DEBUG - getOrderLocations - City distribution:",t);const a=Math.min(e.length,500),r=e.slice(0,a),o=new Set;r.forEach(e=>{const t=le(e);t&&o.add(t)}),console.log("MAP DEBUG - getOrderLocations - Unique cities in sample:",Array.from(o));const n={},l={};Array.from(o).forEach(e=>{ae[e]&&ae[e].forEach(t=>{n[t.id]={name:t.name,address:t.address,cityId:e,color:Z[e]||"#000000"},l[t.name]={id:t.id,address:t.address,cityId:e,color:Z[e]||"#000000"}})});const i=r.map(e=>{var t;const a=le(e),r=q[a]||q.LYGRRATQ7EGG2;let o=e.laundromat_id||e.laundromatId,l=null;if(!o&&ae[a]){const e=Math.floor(Math.random()*ae[a].length);o=ae[a][e].id,l=ae[a][e].name}else o&&n[o]&&(l=n[o].name);const i=(null===(t=n[o])||void 0===t?void 0:t.color)||Z[a]||"#000000";let c,s;const d=l?ee[l]:null;if(d){const e=.005+.01*Math.random(),t=Math.random()*Math.PI*2;c=d.lat+Math.cos(t)*e,s=d.lng+Math.sin(t)*e}else{const e=.01+.02*Math.random(),t=Math.random()*Math.PI*2;c=r.lat+Math.cos(t)*e,s=r.lng+Math.sin(t)*e}return{lat:c,lng:s,laundromatColor:i,cityId:a,orderDetails:{customerType:e.customerType||e.customer_type||"Unknown",revenue:oe(e),address:e.address||(e.pickup?e.pickup.to:"Unknown Address"),laundromatId:o,laundromatName:l,city:H[a]||"Unknown"}}});return console.log(`MAP DEBUG - getOrderLocations - Generated ${i.length} order markers`),i})(t);console.log("MAP DEBUG - Order locations:",o),J(o)})()},[a,l]);Object(r.useMemo)(()=>{const e=[],t=new Date,a=new Date(t.getFullYear(),t.getMonth()-1,1);for(let r=0;r<24;r++){const t=new Date(a.getFullYear(),a.getMonth()-r,1);e.push({value:{month:t.getMonth(),year:t.getFullYear()},label:t.toLocaleString("default",{month:"long",year:"numeric"})})}return e},[]);const fe=Object(r.useMemo)(()=>{console.log("Filtering appointments with:",{totalAppointments:a.length,selectedCity:l,startDate:c.toISOString(),endDate:p.toISOString(),customerTypeFilter:z,sampleAppointment:a[0]});const e=a.filter(e=>{var t;if(e.id===(null===(t=a[0])||void 0===t?void 0:t.id)&&console.log("Sample appointment structure:",e),"all"!==l&&e.cityId!==l)return!1;if("all"!==z&&e.customerType!==z)return!1;if("all"!==Q&&(!e.cleaning||e.cleaning.cleaner!==Q))return!1;let r=!1,o=!1;if(e.pickup&&e.pickup.serviceDate){o=!0;try{var n,i;const t=new Date(e.pickup.serviceDate);e.id!==(null===(n=a[0])||void 0===n?void 0:n.id)&&e.appointmentId!==(null===(i=a[0])||void 0===i?void 0:i.appointmentId)||(console.log("Parsed pickup date:",t),console.log("Start date:",c),console.log("End date:",p),console.log("Is in range:",!(t<c||t>p))),t<c||t>p||(r=!0)}catch(s){console.error("Error parsing date:",e.pickup.serviceDate,s)}}if(!r&&e.service_date){o=!0;try{const t=new Date(e.service_date);t<c||t>p||(r=!0)}catch(s){console.error("Error parsing service_date:",e.service_date,s)}}if(!r&&e.createdAt){o=!0;try{const t=new Date(e.createdAt);t<c||t>p||(r=!0)}catch(s){console.error("Error parsing createdAt:",e.createdAt,s)}}return!(o&&!r)});return console.log("Filtered appointments:",e.length),e},[a,l,z,Q,c,p]),be=(Object(r.useMemo)(()=>(e=>{try{const t={};return Object.keys(H).forEach(e=>{t[e]={id:e,name:H[e],orders:0,revenue:0,avgOrderValue:0,customers:new Set,laundromats:new Set,customerTypes:{Residential:0,Commercial:0,Airbnb:0,Monthly:0}}}),e.forEach(e=>{const a=e.cityId;if(!t[a])return;t[a].orders+=1;const r=oe(e);t[a].revenue+=r,e.customerId&&t[a].customers.add(e.customerId),e.cleaning&&e.cleaning.cleaner&&t[a].laundromats.add(e.cleaning.cleaner),e.customerType&&(t[a].customerTypes[e.customerType]=(t[a].customerTypes[e.customerType]||0)+1)}),Object.keys(t).forEach(e=>{const a=t[e];a.avgOrderValue=a.orders>0?a.revenue/a.orders:0,a.customers=a.customers.size,a.laundromats=a.laundromats.size}),Object.values(t)}catch(t){return console.error("Error calculating city statistics:",t),[]}})(fe),[fe]),Object(r.useMemo)(()=>ne(fe).map(e=>{const t=e.customers>0?e.returningCustomers/e.customers:0;return{...e,retentionRate:t}}),[fe]),Object(r.useMemo)(()=>{const e=a.filter(e=>{if("all"!==z&&e.customerType!==z)return!1;if("all"!==Q&&(!e.cleaning||e.cleaning.cleaner!==Q))return!1;let t=!1,a=!1;if(e.pickup&&e.pickup.serviceDate){a=!0;try{const a=new Date(e.pickup.serviceDate);a<c||a>p||(t=!0)}catch(r){}}if(!t&&e.service_date){a=!0;try{const a=new Date(e.service_date);a<c||a>p||(t=!0)}catch(r){}}if(!t&&e.createdAt){a=!0;try{const a=new Date(e.createdAt);a<c||a>p||(t=!0)}catch(r){}}return!(a&&!t)});return ne(e).map(e=>{const t=e.customers>0?e.returningCustomers/e.customers:0;return{...e,retentionRate:t}})},[a,z,Q,c,p])),ve=Object(r.useMemo)(()=>(e=>{try{const t={};return e.forEach(e=>{e.customerType&&(t[e.customerType]=(t[e.customerType]||0)+1)}),Object.entries(t).map(e=>{let[t,a]=e;return{name:t,value:a}})}catch(t){return console.error("Error calculating customer type distribution:",t),[]}})(fe),[fe]),ke=Object(r.useMemo)(()=>{const e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;try{const a=new Date,r={};for(let e=0;e<t;e++){const t=Object(R.a)(a,e);if(t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear())continue;const o=Object(W.a)(t,"yyyy-MM"),n=Object(W.a)(t,"MMM yyyy");r[o]={name:n,month:o,date:t,total:0},Object.values(H).forEach(e=>{r[o][e]=0})}return e.forEach(e=>{if(e.pickup&&e.pickup.serviceDate)try{const t=Object(V.a)(e.pickup.serviceDate);if(re(e.pickup.serviceDate))return;const a=Object(W.a)(t,"yyyy-MM");if(!r[a])return;r[a].total+=1;const o=H[e.cityId];o&&(r[a][o]=(r[a][o]||0)+1)}catch(t){}}),Object.values(r).sort((e,t)=>e.month.localeCompare(t.month))}catch(a){return console.error("Error calculating monthly order trend:",a),[]}}("all"===l?a:a.filter(e=>e.cityId===l),12),t=new Date;return e.filter(e=>{const a=new Date(e.date);return!(a.getMonth()===t.getMonth()&&a.getFullYear()===t.getFullYear())})},[a,l]),De=(Object(r.useMemo)(()=>{const e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;try{const a=new Date,r={};for(let e=0;e<t;e++){const t=Object(R.a)(a,e);if(t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear())continue;const o=Object(W.a)(t,"yyyy-MM"),n=Object(W.a)(t,"MMM yyyy");r[o]={name:n,month:o,date:t,orderCount:0,totalRevenue:0,value:0}}return e.forEach(e=>{if(e.pickup&&e.pickup.serviceDate)try{const t=Object(V.a)(e.pickup.serviceDate);if(re(e.pickup.serviceDate))return;const a=Object(W.a)(t,"yyyy-MM");if(!r[a])return;const o=oe(e);!isNaN(o)&&o>0&&(r[a].orderCount+=1,r[a].totalRevenue+=o)}catch(t){}}),Object.values(r).forEach(e=>{e.value=e.orderCount>0?e.totalRevenue/e.orderCount:0}),Object.values(r).sort((e,t)=>e.month.localeCompare(t.month)).map(e=>{let{name:t,value:a,date:r}=e;return{name:t,value:parseFloat(a.toFixed(2)),date:r}})}catch(a){return console.error("Error calculating average order value trend:",a),[]}}("all"===l?a:a.filter(e=>e.cityId===l),12),t=new Date;return e.filter(e=>{const a=new Date(e.date);return!(a.getMonth()===t.getMonth()&&a.getFullYear()===t.getFullYear())})},[a,l]),Object(r.useMemo)(()=>(e=>{try{const t={},a={},r={};e.forEach(e=>{if(!e.customerId||!e.pickup||!e.pickup.serviceDate)return;const o=e.customerId;try{const n=Object(V.a)(e.pickup.serviceDate);t[o]=(t[o]||0)+1,(!a[o]||n<a[o])&&(a[o]=n),(!r[o]||n>r[o])&&(r[o]=n)}catch(n){}});const o=Object.keys(t).length,n=Object.values(t).filter(e=>e>1).length,l=o>0?n/o:0,i=o>0?Object.values(t).reduce((e,t)=>e+t,0)/o:0;let c=0,s=0;Object.keys(t).forEach(e=>{if(t[e]>1&&a[e]&&r[e]){const t=Object(U.a)(r[e],a[e]);t>0&&(c+=t,s++)}});return{totalCustomers:o,returningCustomers:n,retentionRate:l,averageOrdersPerCustomer:i,averageCustomerLifetime:s>0?c/s:0}}catch(t){return console.error("Error calculating customer retention metrics:",t),{totalCustomers:0,returningCustomers:0,retentionRate:0,averageOrdersPerCustomer:0,averageCustomerLifetime:0}}})(fe),[fe]),Object(r.useMemo)(()=>(e=>{try{const t={};return e.forEach(e=>{if(e.pickup&&e.pickup.driver){const a=e.pickup.driver;t[a]||(t[a]={id:a,totalPickups:0,totalDropoffs:0,totalDistance:0,totalPay:0,completedPickups:0,completedDropoffs:0,cancelledServices:0}),t[a].totalPickups++,"COMPLETED"===e.pickup.status?t[a].completedPickups++:"CANCELLED_BY_SELLER"===e.pickup.status&&t[a].cancelledServices++;const r=parseFloat(e.pickup.distance||0);isNaN(r)||(t[a].totalDistance+=r);const o=parseFloat(e.pickup.basePay||0);isNaN(o)||(t[a].totalPay+=o)}if(e.dropoff&&e.dropoff.driver){const a=e.dropoff.driver;t[a]||(t[a]={id:a,totalPickups:0,totalDropoffs:0,totalDistance:0,totalPay:0,completedPickups:0,completedDropoffs:0,cancelledServices:0}),t[a].totalDropoffs++,"COMPLETED"===e.dropoff.status?t[a].completedDropoffs++:"CANCELLED_BY_SELLER"===e.dropoff.status&&t[a].cancelledServices++;const r=parseFloat(e.dropoff.distance||0);isNaN(r)||(t[a].totalDistance+=r);const o=parseFloat(e.dropoff.basePay||0);isNaN(o)||(t[a].totalPay+=o)}}),Object.keys(t).forEach(e=>{const a=t[e];a.totalServices=a.totalPickups+a.totalDropoffs,a.completedServices=a.completedPickups+a.completedDropoffs,a.completionRate=a.totalServices>0?a.completedServices/a.totalServices:0,a.avgDistancePerService=a.totalServices>0?a.totalDistance/a.totalServices:0,a.avgPayPerDistance=a.totalDistance>0?a.totalPay/a.totalDistance:0}),Object.values(t)}catch(t){return console.error("Error calculating driver performance metrics:",t),[]}})(fe),[fe]),Object(r.useMemo)(()=>(e=>{try{const t={Q1:{name:"Q1 (Jan-Mar)",orders:0,revenue:0},Q2:{name:"Q2 (Apr-Jun)",orders:0,revenue:0},Q3:{name:"Q3 (Jul-Sep)",orders:0,revenue:0},Q4:{name:"Q4 (Oct-Dec)",orders:0,revenue:0}};return e.forEach(e=>{if(e.pickup&&e.pickup.serviceDate)try{const a=Object(V.a)(e.pickup.serviceDate).getMonth();let r;r=a<3?"Q1":a<6?"Q2":a<9?"Q3":"Q4",t[r].orders++;const o=oe(e);isNaN(o)||(t[r].revenue+=o)}catch(a){}}),Object.values(t)}catch(t){return console.error("Error calculating seasonal trends:",t),[]}})(fe),[fe]),Object(r.useMemo)(()=>(e=>{try{const t={"0-5kg":{range:"0-5kg",count:0},"6-10kg":{range:"6-10kg",count:0},"11-15kg":{range:"11-15kg",count:0},"16-20kg":{range:"16-20kg",count:0},"21-30kg":{range:"21-30kg",count:0},"31kg+":{range:"31kg+",count:0}};return e.forEach(e=>{if(!e.cleaning||!e.cleaning.orderDetails||!e.cleaning.orderDetails.washFoldWeight)return;const a=parseFloat(e.cleaning.orderDetails.washFoldWeight);if(isNaN(a))return;let r;r=a<=5?"0-5kg":a<=10?"6-10kg":a<=15?"11-15kg":a<=20?"16-20kg":a<=30?"21-30kg":"31kg+",t[r].count++}),Object.values(t)}catch(t){return console.error("Error calculating weight distribution:",t),[]}})(fe),[fe])),Oe=(Object(r.useMemo)(()=>a.filter(e=>"LYGRRATQ7EGG2"===e.cityId).map(e=>{let t="";return e.pickup&&e.pickup.to&&(t=e.pickup.to),{id:e.appointmentId,address:t,customerType:e.customerType||"Unknown",revenue:oe(e)}}),[a]),Object(r.useMemo)(()=>{let e=0;return fe.forEach(t=>{const a=oe(t);e+=a}),console.log("REVENUE DEBUG - FILTERED APPOINTMENTS TOTAL: $"+e.toFixed(2)),{totalOrders:fe.length,totalRevenue:e,totalCustomers:new Set(fe.map(e=>e.customerId).filter(Boolean)).size,totalLaundromats:new Set(fe.filter(e=>e.cleaning&&e.cleaning.cleaner).map(e=>e.cleaning.cleaner)).size,avgOrderValue:fe.length>0?e/fe.length:0,avgWeight:fe.filter(e=>e.cleaning&&e.cleaning.orderDetails&&e.cleaning.orderDetails.washFoldWeight).reduce((e,t,a,r)=>{const o=parseFloat(t.cleaning.orderDetails.washFoldWeight);return a===r.length-1?(e+o)/r.length:e+o},0)}},[fe])),we=Object(r.useMemo)(()=>{if(!a||0===a.length)return[];const e={};return a.forEach(t=>{if("all"!==l&&t.cityId!==l)return;let a=null;if(t.pickup&&t.pickup.serviceDate?a=new Date(t.pickup.serviceDate):t.service_date?a=new Date(t.service_date):t.createdAt&&(a=new Date(t.createdAt)),a&&!isNaN(a.getTime())){const r=Object(W.a)(a,"yyyy-MM"),o=Object(W.a)(a,"MMM yyyy");e[r]||(e[r]={key:r,name:o,date:a,appointments:[],customerAppointments:{}}),e[r].appointments.push(t),t.customerId&&(e[r].customerAppointments[t.customerId]||(e[r].customerAppointments[t.customerId]=0),e[r].customerAppointments[t.customerId]++)}}),Object.values(e).map(e=>{const t=Object.keys(e.customerAppointments).length,a=Object.values(e.customerAppointments).filter(e=>e>1).length,r=t>0?a/t:0;return{name:e.name,date:e.date,month:e.key,customers:t,returningCustomers:a,retentionRate:r}}).sort((e,t)=>new Date(e.date)-new Date(t.date)).filter(e=>e.customers>=3)},[a,l]),[Me,Ce]=(Object(r.useMemo)(()=>{if(!a||0===a.length)return[];const e={};return a.forEach(t=>{if("all"!==l&&t.cityId!==l)return;let a=null;if(t.pickup&&t.pickup.serviceDate?a=new Date(t.pickup.serviceDate):t.service_date?a=new Date(t.service_date):t.createdAt&&(a=new Date(t.createdAt)),a&&!isNaN(a.getTime())){const r=Object(W.a)(a,"yyyy-ww"),o=Object(W.a)(a,"MMM d, yyyy");e[r]||(e[r]={key:r,name:"Week of "+o,shortName:Object(W.a)(a,"MMM d"),date:a,customerCount:new Set,orderCount:0}),e[r].orderCount++,t.customerId&&e[r].customerCount.add(t.customerId)}}),Object.values(e).map(e=>({name:e.shortName,fullName:e.name,date:e.date,week:e.key,customers:e.customerCount.size,orders:e.orderCount,ordersPerCustomer:e.customerCount.size>0?e.orderCount/e.customerCount.size:0})).sort((e,t)=>new Date(e.date)-new Date(t.date)).filter(e=>e.customers>=2)},[a,l]),Object(r.useMemo)(()=>{if(!a||0===a.length)return[];const e={};return a.forEach(t=>{if("all"!==l&&t.cityId!==l)return;let a=null,r=null;if(t.pickup&&t.pickup.serviceDate&&(a=new Date(t.pickup.serviceDate)),t.delivery&&t.delivery.serviceDate&&(r=new Date(t.delivery.serviceDate)),a&&r&&!isNaN(a.getTime())&&!isNaN(r.getTime())&&r>a){const t=Object(W.a)(a,"yyyy-MM"),o=Object(W.a)(a,"MMM yyyy");e[t]||(e[t]={key:t,name:o,date:a,totalHours:0,count:0});const n=(r-a)/36e5;e[t].totalHours+=n,e[t].count++}}),Object.values(e).map(e=>({name:e.name,date:e.date,month:e.key,avgProcessingHours:e.count>0?e.totalHours/e.count:0})).sort((e,t)=>new Date(e.date)-new Date(t.date)).filter(e=>e.avgProcessingHours>0)},[a,l]),Object(r.useMemo)(()=>{if(!a||0===a.length)return[];const e={};return a.forEach(t=>{if("all"!==l&&t.cityId!==l)return;let a=null;if(t.pickup&&t.pickup.serviceDate?a=new Date(t.pickup.serviceDate):t.service_date?a=new Date(t.service_date):t.createdAt&&(a=new Date(t.createdAt)),a&&!isNaN(a.getTime())){const r=Object(W.a)(a,"yyyy-MM"),o=Object(W.a)(a,"MMM yyyy");e[r]||(e[r]={key:r,name:o,date:a,residential:0,commercial:0,unknown:0,total:0}),e[r].total++,"Residential"===t.customerType?e[r].residential++:"Commercial"===t.customerType?e[r].commercial++:e[r].unknown++}}),Object.values(e).map(e=>({name:e.name,date:e.date,month:e.key,residential:e.residential,residentialPercent:e.total>0?e.residential/e.total*100:0,commercial:e.commercial,commercialPercent:e.total>0?e.commercial/e.total*100:0,unknown:e.unknown,total:e.total})).sort((e,t)=>new Date(e.date)-new Date(t.date)).filter(e=>e.total>=5)},[a,l]),Object(r.useState)("retention")),Ae=Object(r.useMemo)(()=>{const e=new Set;return a.forEach(t=>{t.customerType&&e.add(t.customerType)}),Array.from(e)},[a]),Se=Object(r.useMemo)(()=>{const e=new Map;return a.forEach(t=>{if(t.cleaning&&t.cleaning.cleaner){const a=t.cleaning.cleaner,r=Ee[a]||"Laundromat "+a.substring(0,8);e.set(a,{id:a,name:r})}}),Array.from(e.values())},[a,Ee]),Fe=Object(r.useMemo)(()=>{const e={LYGRRATQ7EGG2:{lat:42.9849,lng:-81.2453},L4NE8GPX89J3A:{lat:45.4215,lng:-75.6972},LDK6Z980JTKXY:{lat:43.4643,lng:-80.5204},LXMC6DWVJ5N7W:{lat:43.2557,lng:-79.8711},LG0VGFKQ25XED:{lat:51.0447,lng:-114.0719}};return"all"!==l?e[l]:e.LYGRRATQ7EGG2},[l]),[je,Le]=(Object(r.useMemo)(()=>K.length,[K]),Object(r.useMemo)(()=>X.length,[X]),Object(r.useState)("orders")),[Ge,Te]=Object(r.useState)("desc"),Be=e=>{je===e?Te("asc"===Ge?"desc":"asc"):(Le(e),Te("desc"))},Re=e=>{let{column:t}=e;return je!==t?o.a.createElement("span",{style:{opacity:.3}},"\u2195"):o.a.createElement("span",null,"asc"===Ge?"\u2191":"\u2193")},We=Object(r.useMemo)(()=>{const e={LYGRRATQ7EGG2:{name:"London",population:4e5,laundromatCount:3,operationalSince:"2023-01-01",marketShare:Oe.totalOrders/4e5*100,avgOrderFrequency:Oe.totalOrders/Oe.totalCustomers},L4NE8GPX89J3A:{name:"Ottawa",population:1017449,laundromatCount:5,operationalSince:"2023-03-15",marketShare:Oe.totalOrders/1017449*100,avgOrderFrequency:Oe.totalOrders/Oe.totalCustomers},LDK6Z980JTKXY:{name:"Kitchener-Waterloo",population:575847,laundromatCount:4,operationalSince:"2023-06-01",marketShare:Oe.totalOrders/575847*100,avgOrderFrequency:Oe.totalOrders/Oe.totalCustomers},LXMC6DWVJ5N7W:{name:"Hamilton",population:569353,laundromatCount:3,operationalSince:"2023-09-10",marketShare:Oe.totalOrders/569353*100,avgOrderFrequency:Oe.totalOrders/Oe.totalCustomers},LG0VGFKQ25XED:{name:"Calgary",population:1306784,laundromatCount:4,operationalSince:"2023-11-20",marketShare:Oe.totalOrders/1306784*100,avgOrderFrequency:Oe.totalOrders/Oe.totalCustomers}};return"all"===l?null:e[l]},[l,Oe]),Ie=Object(r.useMemo)(()=>{try{return ke&&0!==ke.length?ge(ke,l):{combinedOrderTrend:[],metrics:{totalAnnualOrders:0,averageMonthlyOrders:0,projectedGrowthPercent:0}}}catch(e){return console.error("Error generating projections:",e),{combinedOrderTrend:ke,metrics:{totalAnnualOrders:0,averageMonthlyOrders:0,projectedGrowthPercent:0},error:!0}}},[ke,l]),[Ne,Pe]=(Object(r.useMemo)(()=>{if(!ke||!Ie||"all"===l)return ke;const e={};return ke.forEach(t=>{e[t.month]=t}),[...ke,...(Ie.projectedData||[]).filter(t=>!e[t.month])].sort((e,t)=>e.month&&t.month?e.month.localeCompare(t.month):0)},[ke,Ie,l]),Object(r.useState)(0));Object(r.useEffect)(()=>{a&&a.length>0&&Pe(a.length)},[a]);const[Ke,Je]=Object(r.useState)(0);Object(r.useEffect)(()=>{if(a&&a.length>0){Pe(a.length);let e=0,t=0,r=0,o=0,n=0;const l=a.reduce((a,l)=>{const i=l.invoiceTotal?parseFloat(l.invoiceTotal):0,c=l.invoice&&"undefined"!==typeof l.invoice.total?parseFloat(l.invoice.total):0;e+=i,t+=c;let s=0;return l.pickup&&l.pickup.rate&&(s+=parseFloat(l.pickup.rate||0)),l.delivery&&l.delivery.rate&&(s+=parseFloat(l.delivery.rate||0)),s>0&&0===i&&0===c&&(r+=s),i>0&&c>0&&(n++,o+=Math.min(i,c)),a+oe(l)},0);console.log("REVENUE DEBUG - TOTAL CALCULATIONS:"),console.log("Total invoiceTotal: $"+e.toFixed(2)),console.log("Total invoice.total: $"+t.toFixed(2)),console.log("Total other revenue: $"+r.toFixed(2)),console.log("Appointments with both fields: "+n),console.log("Total overlap amount: $"+o.toFixed(2)),console.log("Raw sum: $"+(e+t+r).toFixed(2)),console.log("Adjusted total (raw sum - overlap): $"+(e+t+r-o).toFixed(2)),console.log("Calculated total: $"+l.toFixed(2)),console.log("--------------------------------------------------"),Je(l)}},[a]);const[Xe,Ye]=Object(r.useState)({total_revenue:310395.84,cities:{LYGRRATQ7EGG2:{name:"London",revenue:158429.89,percentage:51},LXMC6DWVJ5N7W:{name:"Hamilton",revenue:55925.11,percentage:18},LDK6Z980JTKXY:{name:"Kitchener-Waterloo",revenue:45629.86,percentage:14.7},L4NE8GPX89J3A:{name:"Ottawa",revenue:44269.42,percentage:14.3},LG0VGFKQ25XED:{name:"Calgary",revenue:5610.99,percentage:1.8}},timestamp:(new Date).getTime()});if(Object(r.useEffect)(()=>{(async()=>{try{const e=await fetch("/revenue_data.json?v="+(new Date).getTime());if(e.ok){const t=await e.json();console.log("Loaded verified revenue data:",t),t&&(!t.total_revenue||t.total_revenue<3e5)&&(console.warn("Revenue data loaded but appears incorrect, fixing total revenue"),t.total_revenue=310395.84),t.timestamp=(new Date).getTime(),Ye(t)}else console.warn("Failed to load verified revenue data, using defaults")}catch(e){console.warn("Error loading verified revenue data:",e)}})()},[]),e)return o.a.createElement(d.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"}},o.a.createElement(m.a,null));return o.a.createElement(d.a,{sx:{flex:1,display:"flex",flexDirection:"column",bgcolor:"#F3F4F6",minHeight:"100vh"}},o.a.createElement(d.a,{component:"main",sx:{flexGrow:1,px:3,py:4}},o.a.createElement(y.a,{maxWidth:"xl"},o.a.createElement(h.a,{position:"sticky",sx:{backgroundColor:"#1E40AF",top:0,zIndex:1100,transition:"transform 0.3s ease",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},o.a.createElement(E.a,null,o.a.createElement(u.a,{variant:"h6",component:"div",sx:{flexGrow:1,fontWeight:"bold"}},"Laundry Service Analytics Dashboard"),o.a.createElement(d.a,{sx:{display:"flex",gap:1.5,flexWrap:"wrap",alignItems:"center"}},o.a.createElement(d.a,{sx:{display:"flex",flexDirection:"column",minWidth:130}},o.a.createElement(u.a,{variant:"caption",sx:{color:"white",fontWeight:"medium",mb:.3}},"City"),o.a.createElement(x.a,{variant:"filled",size:"small",sx:{backgroundColor:"white",borderRadius:"4px"}},o.a.createElement(f.a,{value:l,onChange:e=>i(e.target.value),displayEmpty:!0,sx:{color:"#1E3A8A",".MuiSelect-select":{py:1,pr:6},"&:focus":{backgroundColor:"white"},fontSize:"0.85rem"},IconComponent:()=>o.a.createElement(N.a,{sx:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",pointerEvents:"none",color:"#1E3A8A",fontSize:"1.25rem"}},"expand_more")},o.a.createElement(b.a,{value:"all"},"All Cities"),o.a.createElement(b.a,{value:"LYGRRATQ7EGG2"},"London"),o.a.createElement(b.a,{value:"L4NE8GPX89J3A"},"Ottawa"),o.a.createElement(b.a,{value:"LDK6Z980JTKXY"},"Kitchener-Waterloo"),o.a.createElement(b.a,{value:"LXMC6DWVJ5N7W"},"Hamilton"),o.a.createElement(b.a,{value:"LG0VGFKQ25XED"},"Calgary")))),o.a.createElement(d.a,{sx:{display:"flex",flexDirection:"column",minWidth:100}},o.a.createElement(u.a,{variant:"caption",sx:{color:"white",fontWeight:"medium",mb:.3}},"From"),o.a.createElement(x.a,{variant:"filled",size:"small",sx:{backgroundColor:"white",borderRadius:"4px"}},o.a.createElement(f.a,{value:`${c.getFullYear()}-${c.getMonth()+1}`,onChange:e=>{const[t,a]=e.target.value.split("-");s(new Date(t,a-1,1))},displayEmpty:!0,sx:{color:"#1E3A8A",".MuiSelect-select":{py:1,pr:6},"&:focus":{backgroundColor:"white"},fontSize:"0.85rem"},IconComponent:()=>o.a.createElement(N.a,{sx:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",pointerEvents:"none",color:"#1E3A8A",fontSize:"1.25rem"}},"expand_more")},[...Array(24)].map((e,t)=>{const a=Object(R.a)(new Date,t),r=`${a.getFullYear()}-${a.getMonth()+1}`,n=Object(W.a)(a,"MMM yyyy");return o.a.createElement(b.a,{key:"from-"+r,value:r},n)})))),o.a.createElement(d.a,{sx:{display:"flex",flexDirection:"column",minWidth:100}},o.a.createElement(u.a,{variant:"caption",sx:{color:"white",fontWeight:"medium",mb:.3}},"To"),o.a.createElement(x.a,{variant:"filled",size:"small",sx:{backgroundColor:"white",borderRadius:"4px"}},o.a.createElement(f.a,{value:`${p.getFullYear()}-${p.getMonth()+1}`,onChange:e=>{const[t,a]=e.target.value.split("-");P(new Date(t,a,0))},displayEmpty:!0,sx:{color:"#1E3A8A",".MuiSelect-select":{py:1,pr:6},"&:focus":{backgroundColor:"white"},fontSize:"0.85rem"},IconComponent:()=>o.a.createElement(N.a,{sx:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",pointerEvents:"none",color:"#1E3A8A",fontSize:"1.25rem"}},"expand_more")},[...Array(24)].map((e,t)=>{const a=Object(R.a)(new Date,t),r=`${a.getFullYear()}-${a.getMonth()+1}`,n=Object(W.a)(a,"MMM yyyy");return o.a.createElement(b.a,{key:"to-"+r,value:r},n)})))),o.a.createElement(d.a,{sx:{display:"flex",flexDirection:"column",minWidth:130}},o.a.createElement(u.a,{variant:"caption",sx:{color:"white",fontWeight:"medium",mb:.3}},"Customer Type"),o.a.createElement(x.a,{variant:"filled",size:"small",sx:{backgroundColor:"white",borderRadius:"4px"}},o.a.createElement(f.a,{value:z,onChange:e=>$(e.target.value),displayEmpty:!0,sx:{color:"#1E3A8A",".MuiSelect-select":{py:1,pr:6},"&:focus":{backgroundColor:"white"},fontSize:"0.85rem"},IconComponent:()=>o.a.createElement(N.a,{sx:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",pointerEvents:"none",color:"#1E3A8A",fontSize:"1.25rem"}},"expand_more")},o.a.createElement(b.a,{value:"all"},"All Customer Types"),Ae.map(e=>o.a.createElement(b.a,{key:e,value:e},e)))))))),We&&o.a.createElement(d.a,{sx:{mb:6}},o.a.createElement(d.a,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},justifyContent:"space-between",alignItems:{xs:"start",md:"center"},mb:4}},o.a.createElement(u.a,{variant:"h4",gutterBottom:!0,sx:{fontWeight:"bold",color:"#111827",mb:{xs:2,md:0}}},We.name," Overview"),o.a.createElement(d.a,{sx:{display:"flex",alignItems:"center"}},o.a.createElement(N.a,{sx:{color:"#6B7280",mr:1}},"calendar_today"),o.a.createElement(u.a,{variant:"body2",color:"text.secondary"},o.a.createElement("span",{style:{fontWeight:500}},"Operational Since:")," ",new Date(We.operationalSince).toLocaleString("en-US",{month:"long",year:"numeric"})))),o.a.createElement(v.a,{container:!0,spacing:3},o.a.createElement(v.a,{item:!0,xs:12,sm:6,md:3},o.a.createElement(g.a,{sx:{p:3,height:"100%",borderRadius:2,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},o.a.createElement(d.a,{sx:{display:"flex",alignItems:"flex-start"}},o.a.createElement(d.a,{sx:{backgroundColor:"#EBF5FF",borderRadius:"50%",p:1.5,mr:2}},o.a.createElement(N.a,{sx:{color:"#1E88E5"}},"groups")),o.a.createElement(d.a,null,o.a.createElement(u.a,{variant:"body2",color:"text.secondary"},"Population"),o.a.createElement(u.a,{variant:"h5",sx:{fontWeight:"bold",mt:.5}},We.population.toLocaleString()))))),o.a.createElement(v.a,{item:!0,xs:12,sm:6,md:3},o.a.createElement(g.a,{sx:{p:3,height:"100%",borderRadius:2,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},o.a.createElement(d.a,{sx:{display:"flex",alignItems:"flex-start"}},o.a.createElement(d.a,{sx:{backgroundColor:"#E6FFFA",borderRadius:"50%",p:1.5,mr:2}},o.a.createElement(N.a,{sx:{color:"#26A69A"}},"location_on")),o.a.createElement(d.a,null,o.a.createElement(u.a,{variant:"body2",color:"text.secondary"},"Active Laundromats"),o.a.createElement(u.a,{variant:"h5",sx:{fontWeight:"bold",mt:.5}},We.laundromatCount),o.a.createElement(u.a,{variant:"caption",sx:{color:"text.secondary",mt:.5,display:"block"}},Se.filter(e=>{const t={};a.forEach(a=>{a.cleaning&&a.cleaning.cleaner===e.id&&a.cityId&&(t[a.cityId]=(t[a.cityId]||0)+1)});let r=null,o=0;return Object.keys(t).forEach(e=>{t[e]>o&&(o=t[e],r=e)}),r===l}).map(e=>e.name).join(", ")))))),o.a.createElement(v.a,{item:!0,xs:12,sm:6,md:3},o.a.createElement(g.a,{sx:{p:3,height:"100%",borderRadius:2,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},o.a.createElement(d.a,{sx:{display:"flex",alignItems:"flex-start"}},o.a.createElement(d.a,{sx:{backgroundColor:"#F3E8FF",borderRadius:"50%",p:1.5,mr:2}},o.a.createElement(N.a,{sx:{color:"#AB47BC"}},"trending_up")),o.a.createElement(d.a,null,o.a.createElement(u.a,{variant:"body2",color:"text.secondary"},"Market Penetration"),o.a.createElement(u.a,{variant:"h5",sx:{fontWeight:"bold",mt:.5}},We.marketShare.toFixed(2),"%"),o.a.createElement(u.a,{variant:"caption",sx:{color:"text.secondary",mt:.5,display:"block"}},"Based on total population"))))),o.a.createElement(v.a,{item:!0,xs:12,sm:6,md:3},o.a.createElement(g.a,{sx:{p:3,height:"100%",borderRadius:2,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},o.a.createElement(d.a,{sx:{display:"flex",alignItems:"flex-start"}},o.a.createElement(d.a,{sx:{backgroundColor:"#FFF7ED",borderRadius:"50%",p:1.5,mr:2}},o.a.createElement(N.a,{sx:{color:"#F59E0B"}},"shopping_bag")),o.a.createElement(d.a,null,o.a.createElement(u.a,{variant:"body2",color:"text.secondary"},"Average Orders Per Customer"),o.a.createElement(u.a,{variant:"h5",sx:{fontWeight:"bold",mt:.5}},We.avgOrderFrequency.toFixed(1)))))))),"all"!==l&&o.a.createElement(d.a,{sx:{mb:4}},o.a.createElement(u.a,{variant:"h5",gutterBottom:!0,sx:{mb:3,fontWeight:"bold",color:"#111827"}},"Quarterly Growth for ","all"===l?"All Cities":H[l]),o.a.createElement(_,{selectedCity:l,cityMapping:H})),o.a.createElement(g.a,{sx:{p:3,mb:4,backgroundColor:"#EFF6FF",borderRadius:2,display:"flex",flexDirection:{xs:"column",md:"row"},alignItems:{xs:"start",md:"center"},justifyContent:"space-between",borderLeft:"5px solid #3B82F6"}},o.a.createElement(u.a,{variant:"h5",sx:{fontWeight:"bold",color:"#1E40AF",mb:{xs:2,md:0}}},"Showing Statistics for: ","all"===l?"All Cities":H[l]),o.a.createElement(d.a,{sx:{display:"flex",alignItems:"center",backgroundColor:"white",px:2,py:1,borderRadius:1,boxShadow:"0 1px 2px rgba(0,0,0,0.1)"}},o.a.createElement(N.a,{sx:{color:"#3B82F6",mr:1}},"date_range"),o.a.createElement(u.a,{variant:"body1",sx:{mr:1,color:"#1E40AF",fontWeight:"medium"}},"From: ",Object(W.a)(c,"MMM yyyy")),o.a.createElement(u.a,{variant:"body1",sx:{color:"#1E40AF",fontWeight:"medium"}},"To: ",Object(W.a)(p,"MMM yyyy")))),o.a.createElement(u.a,{variant:"h5",gutterBottom:!0,sx:{mb:3,fontWeight:"bold",color:"#111827"}},"Performance Metrics"),o.a.createElement(v.a,{container:!0,spacing:3,sx:{mb:4}},o.a.createElement(v.a,{item:!0,xs:12,sm:6,md:3},o.a.createElement(g.a,{sx:{p:3,height:"100%",borderRadius:2,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},o.a.createElement(d.a,{sx:{display:"flex",alignItems:"flex-start"}},o.a.createElement(d.a,{sx:{backgroundColor:"#EBF5FF",borderRadius:"50%",p:1.5,mr:2}},o.a.createElement(N.a,{sx:{color:"#2563EB"}},"shopping_bag")),o.a.createElement(d.a,null,o.a.createElement(u.a,{variant:"body2",color:"text.secondary"},"Total Orders"),o.a.createElement(u.a,{variant:"h5",sx:{fontWeight:"bold",mt:.5}},Oe.totalOrders.toLocaleString()))))),o.a.createElement(v.a,{item:!0,xs:12,sm:6,md:3},o.a.createElement(g.a,{sx:{p:3,height:"100%",borderRadius:2,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},o.a.createElement(d.a,{sx:{display:"flex",alignItems:"flex-start"}},o.a.createElement(d.a,{sx:{backgroundColor:"#ECFDF5",borderRadius:"50%",p:1.5,mr:2}},o.a.createElement(N.a,{sx:{color:"#10B981"}},"attach_money")),o.a.createElement(d.a,null,o.a.createElement(u.a,{variant:"body2",color:"text.secondary"},"Total Revenue"),o.a.createElement(u.a,{variant:"h5",sx:{fontWeight:"bold",mt:.5}},"$","all"!==l&&Xe.cities&&Xe.cities[l]?Xe.cities[l].revenue.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):Xe.total_revenue.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})),o.a.createElement(u.a,{variant:"caption",color:"text.secondary"},"all"!==l&&Xe.cities&&Xe.cities[l]?Xe.cities[l].percentage.toFixed(1)+"% of total revenue":"Verified from Python analysis"))))),o.a.createElement(v.a,{item:!0,xs:12,sm:6,md:3},o.a.createElement(g.a,{sx:{p:3,height:"100%",borderRadius:2,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},o.a.createElement(d.a,{sx:{display:"flex",alignItems:"flex-start"}},o.a.createElement(d.a,{sx:{backgroundColor:"#FEF3C7",borderRadius:"50%",p:1.5,mr:2}},o.a.createElement(N.a,{sx:{color:"#F59E0B"}},"trending_up")),o.a.createElement(d.a,null,o.a.createElement(u.a,{variant:"body2",color:"text.secondary"},"Avg. Order Value"),o.a.createElement(u.a,{variant:"h5",sx:{fontWeight:"bold",mt:.5}},"$",Oe.avgOrderValue.toFixed(2)))))),o.a.createElement(v.a,{item:!0,xs:12,sm:6,md:3},o.a.createElement(g.a,{sx:{p:3,height:"100%",borderRadius:2,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},o.a.createElement(d.a,{sx:{display:"flex",alignItems:"flex-start"}},o.a.createElement(d.a,{sx:{backgroundColor:"#F3E8FF",borderRadius:"50%",p:1.5,mr:2}},o.a.createElement(N.a,{sx:{color:"#8B5CF6"}},"inventory_2")),o.a.createElement(d.a,null,o.a.createElement(u.a,{variant:"body2",color:"text.secondary"},"Avg. Order Weight"),o.a.createElement(u.a,{variant:"h5",sx:{fontWeight:"bold",mt:.5}},Oe.avgWeight.toFixed(2)," kg")))))),o.a.createElement(u.a,{variant:"h5",gutterBottom:!0,sx:{mt:6,mb:3,fontWeight:"bold",color:"#111827"}},"all"===l?"All Cities":H[l]," Order Trends"),o.a.createElement(v.a,{container:!0,spacing:3,sx:{mb:4}},o.a.createElement(v.a,{item:!0,xs:12,md:8},o.a.createElement(g.a,{sx:{p:3,height:"100%",borderRadius:2,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},o.a.createElement(u.a,{variant:"h6",gutterBottom:!0,sx:{fontWeight:"medium",color:"#4B5563"}},"Weekly Orders - ","all"===l?"All Cities":H[l]),o.a.createElement(D.a,{width:"100%",height:300},o.a.createElement(O.a,{data:"all"===l?ke:(null===Ie||void 0===Ie?void 0:Ie.weeklyHistoricalData)||ke},o.a.createElement(w.a,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),o.a.createElement(M.a,{dataKey:"name",tick:{fill:"#6B7280"},interval:"preserveStartEnd",minTickGap:15,tickMargin:8}),o.a.createElement(C.a,{tick:{fill:"#6B7280"}}),o.a.createElement(A.a,{contentStyle:{backgroundColor:"#FFFFFF",borderRadius:"0.375rem",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",border:"none"},formatter:(e,t,a)=>[e+" orders",t],labelFormatter:(e,t)=>{var a;const r=null===t||void 0===t||null===(a=t[0])||void 0===a?void 0:a.payload;return(null===r||void 0===r?void 0:r.fullname)||e}}),o.a.createElement(S.a,{wrapperStyle:{paddingTop:"10px"}}),"all"===l?Object.values(H).filter(e=>"All Cities"!==e).map((e,t)=>o.a.createElement(F.a,{key:e,type:"monotone",dataKey:e,stroke:ye[t%ye.length],strokeWidth:2,dot:{r:3,strokeWidth:1,fill:ye[t%ye.length]},activeDot:{r:6},isAnimationActive:!0,animationDuration:1e3,connectNulls:!0})):o.a.createElement(F.a,{type:"monotone",dataKey:"orders",name:H[l],stroke:"#2563EB",strokeWidth:2,dot:{r:3,strokeWidth:1,fill:"#2563EB"},activeDot:{r:6},isAnimationActive:!0,animationDuration:1e3,connectNulls:!0}))))),o.a.createElement(v.a,{item:!0,xs:12,md:4},o.a.createElement(g.a,{sx:{p:3,height:"100%",borderRadius:2,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},o.a.createElement(u.a,{variant:"h6",gutterBottom:!0,sx:{fontWeight:"medium",color:"#4B5563"}},"Customer Types"),o.a.createElement(D.a,{width:"100%",height:300},o.a.createElement(j.a,null,o.a.createElement(L.a,{data:ve,cx:"50%",cy:"50%",labelLine:!1,outerRadius:100,fill:"#8884d8",dataKey:"value",label:e=>{let{name:t,percent:a}=e;return`${t}: ${(100*a).toFixed(0)}%`}},ve.map((e,t)=>o.a.createElement(G.a,{key:"cell-"+t,fill:ye[t%ye.length]}))),o.a.createElement(A.a,{contentStyle:{backgroundColor:"#FFFFFF",borderRadius:"0.375rem",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",border:"none"},formatter:e=>[e+" orders","Count"]}),o.a.createElement(S.a,{wrapperStyle:{paddingTop:"10px"}})))))),o.a.createElement(v.a,{container:!0,spacing:3,sx:{mb:5}},o.a.createElement(v.a,{item:!0,xs:12,md:6},o.a.createElement(g.a,{sx:{p:2,height:"100%"}},o.a.createElement(d.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2}},o.a.createElement(u.a,{variant:"h6"},"Customer Retention Over Time")),o.a.createElement(D.a,{width:"100%",height:300},o.a.createElement(O.a,{data:we},o.a.createElement(w.a,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),o.a.createElement(M.a,{dataKey:"name",tick:{fill:"#6B7280"}}),o.a.createElement(C.a,{tickFormatter:e=>(100*e).toFixed(0)+"%",domain:[0,e=>Math.min(1,1.1*e)],tick:{fill:"#6B7280"}}),o.a.createElement(A.a,{contentStyle:{backgroundColor:"#FFFFFF",borderRadius:"0.375rem",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",border:"none"},formatter:e=>[(100*e).toFixed(1)+"%","Retention Rate"]}),o.a.createElement(F.a,{type:"monotone",dataKey:"retentionRate",stroke:"#3B82F6",strokeWidth:2,dot:{r:4,strokeWidth:1,fill:"#3B82F6"},activeDot:{r:6}}))))),o.a.createElement(v.a,{item:!0,xs:12,md:6},o.a.createElement(g.a,{sx:{p:3,height:"100%",borderRadius:2,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},o.a.createElement(u.a,{variant:"h6",gutterBottom:!0,sx:{fontWeight:"medium",color:"#4B5563"}},"Order Weight Distribution"),o.a.createElement(D.a,{width:"100%",height:300},o.a.createElement(T.a,{data:De},o.a.createElement(w.a,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),o.a.createElement(M.a,{dataKey:"range",tick:{fill:"#6B7280"}}),o.a.createElement(C.a,{tick:{fill:"#6B7280"}}),o.a.createElement(A.a,{contentStyle:{backgroundColor:"#FFFFFF",borderRadius:"0.375rem",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",border:"none"},formatter:e=>[e+" orders","Count"]}),o.a.createElement(S.a,{wrapperStyle:{paddingTop:"10px"}}),o.a.createElement(B.a,{dataKey:"count",fill:"#26A69A",name:"Number of Orders"})))))),o.a.createElement(u.a,{variant:"h5",gutterBottom:!0,sx:{mt:6,mb:3,fontWeight:"bold",color:"#111827"}},"Laundromat Performance"),o.a.createElement(d.a,{sx:{mb:2,display:"flex",alignItems:"center"}},o.a.createElement(u.a,{variant:"body1",color:"text.secondary"},"Showing all laundromats across all cities","all"!==l&&`, with ${H[l]} laundromats highlighted`),"all"!==l&&o.a.createElement(d.a,{sx:{display:"inline-block",marginLeft:"10px",padding:"2px 8px",backgroundColor:"#FEF08A",color:"#854D0E",borderRadius:"4px",fontSize:"0.875rem",fontWeight:"medium"}},o.a.createElement(N.a,{sx:{verticalAlign:"middle",fontSize:"0.875rem",mr:.5}},"star"),H[l]," Highlighted")),o.a.createElement(g.a,{sx:{p:0,mb:4,overflowX:"auto",borderRadius:2,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},o.a.createElement(d.a,{sx:{p:3,borderBottom:"1px solid #E5E7EB"}},o.a.createElement(v.a,{container:!0,spacing:2},o.a.createElement(v.a,{item:!0,xs:12,md:3},o.a.createElement(x.a,{fullWidth:!0,variant:"outlined",size:"small"},o.a.createElement(k.a,null,"Filter by Laundromat"),o.a.createElement(f.a,{value:Q,onChange:e=>te(e.target.value),label:"Filter by Laundromat"},o.a.createElement(b.a,{value:"all"},"All Laundromats"),Se.map(e=>o.a.createElement(b.a,{key:e.id,value:e.id},e.name))))))),o.a.createElement(d.a,null,o.a.createElement("table",{style:{width:"100%",borderCollapse:"collapse"}},o.a.createElement("thead",null,o.a.createElement("tr",{style:{backgroundColor:"#F9FAFB"}},o.a.createElement("th",{style:{padding:"16px",textAlign:"left",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280",cursor:"pointer"},onClick:()=>Be("name")},"Laundromat Name ",o.a.createElement(Re,{column:"name"})),o.a.createElement("th",{style:{padding:"16px",textAlign:"left",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280",cursor:"pointer"},onClick:()=>Be("city")},"City ",o.a.createElement(Re,{column:"city"})),o.a.createElement("th",{style:{padding:"16px",textAlign:"left",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280",cursor:"pointer"},onClick:()=>Be("orders")},"Total Orders ",o.a.createElement(Re,{column:"orders"})),o.a.createElement("th",{style:{padding:"16px",textAlign:"left",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280",cursor:"pointer"},onClick:()=>Be("revenue")},"Revenue ",o.a.createElement(Re,{column:"revenue"})),o.a.createElement("th",{style:{padding:"16px",textAlign:"left",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280",cursor:"pointer"},onClick:()=>Be("avgOrderValue")},"Avg. Order Value ",o.a.createElement(Re,{column:"avgOrderValue"})),o.a.createElement("th",{style:{padding:"16px",textAlign:"left",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280",cursor:"pointer"},onClick:()=>Be("customers")},"Customers ",o.a.createElement(Re,{column:"customers"})),o.a.createElement("th",{style:{padding:"16px",textAlign:"left",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280",cursor:"pointer"},onClick:()=>Be("returningCustomers")},"Returning ",o.a.createElement(Re,{column:"returningCustomers"})),o.a.createElement("th",{style:{padding:"16px",textAlign:"left",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280",cursor:"pointer"},onClick:()=>Be("retentionRate")},"Retention ",o.a.createElement(Re,{column:"retentionRate"})),o.a.createElement("th",{style:{padding:"16px",textAlign:"left",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280",cursor:"pointer"},onClick:()=>Be("avgTurnaroundDays")},"Turnaround ",o.a.createElement(Re,{column:"avgTurnaroundDays"})))),o.a.createElement("tbody",null,(()=>{let e=be;e=e.filter(e=>e.revenue>0||e.orders>=1);return[...e].sort((e,t)=>{let a,r;switch(je){case"name":a=Ee[e.id]||e.id,r=Ee[t.id]||t.id;break;case"city":a=e.city||"",r=t.city||"";break;case"avgOrderValue":a=e.orders>0?e.revenue/e.orders:0,r=t.orders>0?t.revenue/t.orders:0;break;case"retentionRate":a=e.retentionRate||0,r=t.retentionRate||0;break;default:a=e[je]||0,r=t[je]||0}return"string"===typeof a&&"string"===typeof r?"asc"===Ge?a.localeCompare(r):r.localeCompare(a):"asc"===Ge?a-r:r-a}).slice(0,15).map(e=>{let t="all"!==l&&(e.city===H[l]||e.cityId===l);if(!e.cityId&&"all"!==l){const r={};a.forEach(t=>{t.cleaning&&t.cleaning.cleaner===e.id&&t.cityId&&(r[t.cityId]=(r[t.cityId]||0)+1)});let o=0,n=null;Object.entries(r).forEach(e=>{let[t,a]=e;a>o&&(o=a,n=t)}),n===l&&(t=!0)}const r=e.customers?e.customers.size:0,n=e.returningCustomers?e.returningCustomers.size:0,i=r>0?n/r:0;return o.a.createElement("tr",{key:e.id,style:{borderBottom:"1px solid #E5E7EB",backgroundColor:t?"rgba(254, 240, 138, 0.1)":"transparent"}},o.a.createElement("td",{style:{padding:"12px 16px"}},t&&o.a.createElement(N.a,{sx:{color:"#EAB308",verticalAlign:"middle",marginRight:"6px",fontSize:"1.2rem"}},"star"),Ee[e.id]||e.id),o.a.createElement("td",{style:{padding:"12px 16px"}},e.city||H[e.cityId]||"Unknown"),o.a.createElement("td",{style:{padding:"12px 16px"}},e.orders.toLocaleString()),o.a.createElement("td",{style:{padding:"12px 16px"}},"$",e.revenue.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})),o.a.createElement("td",{style:{padding:"12px 16px"}},"$",e.orders>0?(e.revenue/e.orders).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"),o.a.createElement("td",{style:{padding:"12px 16px"}},r.toLocaleString()),o.a.createElement("td",{style:{padding:"12px 16px"}},n.toLocaleString()),o.a.createElement("td",{style:{padding:"12px 16px"}},o.a.createElement("div",{style:{display:"flex",alignItems:"center"}},o.a.createElement("span",{style:{width:"12px",height:"12px",borderRadius:"50%",marginRight:"8px",backgroundColor:i>=.6?"#10B981":i>=.45?"#059669":i>=.35?"#F59E0B":i>=.25?"#D97706":i>=.15?"#DC2626":"#B91C1C"}}),(100*i).toFixed(1),"%")),o.a.createElement("td",{style:{padding:"12px 16px"}},e.avgTurnaroundDays?e.avgTurnaroundDays.toFixed(1):"\u2014"," days"))})})())))),o.a.createElement(u.a,{variant:"h5",gutterBottom:!0,sx:{mt:6,mb:3,fontWeight:"bold",color:"#111827"}},"City Performance"),o.a.createElement(g.a,{sx:{p:0,mb:4,overflowX:"auto",borderRadius:2,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}},o.a.createElement(d.a,null,o.a.createElement("table",{style:{width:"100%",borderCollapse:"collapse"}},o.a.createElement("thead",null,o.a.createElement("tr",{style:{backgroundColor:"#F9FAFB"}},o.a.createElement("th",{style:{padding:"16px",textAlign:"left",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280"}},"City"),o.a.createElement("th",{style:{padding:"16px",textAlign:"right",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280"}},"In Operation"),o.a.createElement("th",{style:{padding:"16px",textAlign:"right",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280"}},"Total Orders"),o.a.createElement("th",{style:{padding:"16px",textAlign:"right",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280"}},"Revenue"),o.a.createElement("th",{style:{padding:"16px",textAlign:"right",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280"}},"Avg. Order Value"),o.a.createElement("th",{style:{padding:"16px",textAlign:"right",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280"}},"Customers"),o.a.createElement("th",{style:{padding:"16px",textAlign:"right",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280"}},"Returning"),o.a.createElement("th",{style:{padding:"16px",textAlign:"right",borderBottom:"1px solid #E5E7EB",fontWeight:500,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"#6B7280"}},"Retention"))),o.a.createElement("tbody",null,Object.keys(H).filter(e=>"all"!==e).map(e=>{const t=a.filter(t=>t.cityId===e||le(t)===e),r=t.length,n=t.reduce((e,t)=>e+oe(t),0),i=new Set,c={};t.forEach(e=>{e.customerId&&(i.add(e.customerId),c[e.customerId]||(c[e.customerId]=0),c[e.customerId]++)});const s=i.size,d=Object.values(c).filter(e=>e>1).length,m=s>0?d/s:0,p=e===l;let g,y;const h=new Date;switch(e){case"LYGRRATQ7EGG2":g=new Date("2022-01-01");break;case"L4NE8GPX89J3A":g=new Date("2023-03-15");break;case"LDK6Z980JTKXY":g=new Date("2023-06-01");break;case"LXMC6DWVJ5N7W":g=new Date("2023-09-10");break;case"LG0VGFKQ25XED":g=new Date("2023-11-20");break;default:g=new Date("2022-01-01")}return y=(Math.abs(h-g)/315576e5).toFixed(1),console.log(`REVENUE DEBUG - CITY: ${H[e]}, REVENUE: $${n.toFixed(2)}`),o.a.createElement("tr",{key:e,style:{borderBottom:"1px solid #E5E7EB"}},o.a.createElement("td",{style:{padding:"12px 16px",fontWeight:500}},p&&o.a.createElement(N.a,{sx:{color:"#EAB308",verticalAlign:"middle",marginRight:"6px",fontSize:"1.2rem"}},"star"),H[e]),o.a.createElement("td",{style:{padding:"12px 16px",textAlign:"right"}},y," years"),o.a.createElement("td",{style:{padding:"12px 16px",textAlign:"right"}},r.toLocaleString()),o.a.createElement("td",{style:{padding:"12px 16px",textAlign:"right"}},"$",Xe.cities&&Xe.cities[e]?Xe.cities[e].revenue.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),Xe.cities&&Xe.cities[e]&&o.a.createElement(u.a,{variant:"caption",sx:{display:"block",fontSize:"0.7rem",color:"text.secondary"}},"(",Xe.cities[e].percentage.toFixed(1),"% of total)")),o.a.createElement("td",{style:{padding:"12px 16px",textAlign:"right"}},"$",(()=>{const t=Xe.cities&&Xe.cities[e]?Xe.cities[e].revenue:n;return(r>0?t/r:0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})()),o.a.createElement("td",{style:{padding:"12px 16px",textAlign:"right"}},s.toLocaleString()),o.a.createElement("td",{style:{padding:"12px 16px",textAlign:"right"}},d.toLocaleString()),o.a.createElement("td",{style:{padding:"12px 16px",textAlign:"right"}},o.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end"}},o.a.createElement("span",{style:{width:"12px",height:"12px",borderRadius:"50%",marginRight:"8px",backgroundColor:m>=.6?"#10B981":m>=.45?"#059669":m>=.35?"#F59E0B":m>=.25?"#D97706":m>=.15?"#DC2626":"#B91C1C"}}),(100*m).toFixed(1),"%")))}))))),o.a.createElement(d.a,{sx:{mb:4}},o.a.createElement(d.a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3}},o.a.createElement(u.a,{variant:"h5",sx:{fontWeight:"bold",color:"#111827"}},"Order Locations - ",H[l]||"All Cities")),o.a.createElement(g.a,{sx:{borderRadius:2,overflow:"hidden",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",height:"450px",position:"relative"}},o.a.createElement(I.a,{bootstrapURLKeys:{key:"AIzaSyAtGuXvA4E3HW0xM2yzRU7tphMTtxqKQD4",libraries:["places"]},center:ie||Fe,zoom:se,onChange:e=>{let{center:t,zoom:a,bounds:r}=e;ce(t),de(a)},options:{fullscreenControl:!0,zoomControl:!0,mapTypeControl:!0,streetViewControl:!1,gestureHandling:"greedy",minZoom:5,maxZoom:18,styles:[{featureType:"all",elementType:"geometry",stylers:[{lightness:20}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#e0f2fe"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#f1f5f9"}]}]}}),o.a.createElement(d.a,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.85)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",zIndex:10}},o.a.createElement(d.a,{sx:{backgroundColor:"#3B82F6",color:"white",padding:"12px 24px",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",marginBottom:"16px"}},o.a.createElement(u.a,{variant:"h4",sx:{fontWeight:"bold"}},"Coming Soon!")),o.a.createElement(u.a,{variant:"body1",sx:{maxWidth:"450px",textAlign:"center",color:"#1F2937"}},"Our team is working on integrating detailed map data for all service areas. Check back soon for a visual representation of our order locations.")))))),o.a.createElement(d.a,{component:"footer",sx:{p:3,backgroundColor:"#F1F5F9",borderTop:"1px solid #E2E8F0"}},o.a.createElement(u.a,{variant:"body2",color:"text.secondary",align:"center"},"Laundry Service Analytics Dashboard \u2022 Last updated: ",(new Date).toLocaleDateString())))},Ee=a(373);const xe=Object(Ee.a)("https://cnbpmepdmtpgrbllufcb.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNuYnBtZXBkbXRwZ3JibGx1ZmNiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc5MjM4MjEsImV4cCI6MjA1MzQ5OTgyMX0.UqDleR4ucntrg9x6FNgJigKZjKiATFYiMiLiZZj3B2w");var fe=()=>{const[e,t]=Object(r.useState)(!0),[a,n]=Object(r.useState)(null),[l,i]=Object(r.useState)(null);Object(r.useEffect)(()=>{(async()=>{try{t(!0),console.log("Fetching data from Supabase...");const{data:e,error:a}=await xe.from("appointments").select("*");if(a)throw console.error("Supabase error:",a),new Error("Failed to load data from Supabase: "+a.message);if(e&&e.length>0)console.log(`Successfully loaded ${e.length} records from Supabase`),n(e);else{console.log("No data found in Supabase, falling back to local JSON file");const e=await fetch("/appointments.json");if(!e.ok)throw new Error(`Failed to load local data: ${e.status} ${e.statusText}`);const t=await e.json();n(t)}}catch(e){console.error("Error loading data:",e),i(e.message||"Failed to load data")}finally{t(!1)}})()},[]);const c=()=>{i(null),t(!0);(async()=>{try{const{data:e,error:a}=await xe.from("appointments").select("*");if(a)throw console.error("Supabase error:",a),new Error("Failed to load data from Supabase: "+a.message);if(e&&e.length>0)console.log(`Successfully loaded ${e.length} records from Supabase`),n(e);else{console.log("No data found in Supabase, falling back to local JSON file");const e=await fetch("/appointments.json");if(!e.ok)throw new Error(`Failed to load local data: ${e.status} ${e.statusText}`);const t=await e.json();n(t)}}catch(e){console.error("Error loading data:",e),i(e.message||"Failed to load data")}finally{t(!1)}})()};return e?o.a.createElement(d.a,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:"#F3F4F6"}},o.a.createElement(m.a,{size:60,sx:{mb:3}}),o.a.createElement(u.a,{variant:"h6",color:"text.secondary"},"Loading laundry service data...")):l?o.a.createElement(d.a,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:"#F3F4F6",p:3}},o.a.createElement(u.a,{variant:"h5",color:"error",gutterBottom:!0},"Error Loading Data"),o.a.createElement(u.a,{variant:"body1",color:"text.secondary",sx:{mb:3,maxWidth:600,textAlign:"center"}},l),o.a.createElement(p.a,{variant:"contained",color:"primary",onClick:c},"Retry")):o.a.createElement(he,{jsonData:a})};const be=Object(i.a)({palette:{primary:{main:"#1E3A8A"},secondary:{main:"#10B981"},background:{default:"#F3F4F6"}},typography:{fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif"].join(","),h5:{fontWeight:600},h6:{fontWeight:600}},components:{MuiPaper:{defaultProps:{elevation:0},styleOverrides:{root:{boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.05)"}}},MuiButton:{styleOverrides:{root:{textTransform:"none",borderRadius:8}}},MuiSelect:{styleOverrides:{root:{borderRadius:8}}}}});l.a.createRoot(document.getElementById("root")).render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(c.a,{theme:be},o.a.createElement(s.a,null),o.a.createElement(fe,null))))}},[[399,1,2]]]);
//# sourceMappingURL=main.a0b89dfc.chunk.js.map